<!DOCTYPE html>
<html lang="en"
    data-content_root="./"
    x-data="{ darkMode: localStorage.getItem('darkMode') || localStorage.setItem('darkMode', 'system'), activeSection: '' }"
    x-init="$watch('darkMode', val => localStorage.setItem('darkMode', val))"
    class="scroll-smooth"
    :class="{'dark': darkMode === 'dark' || (darkMode === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches)}"
    >
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta name="theme-color" media="(prefers-color-scheme: light)"
            content="white" />
        <meta name="theme-color" media="(prefers-color-scheme: dark)"
            content="black" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <title>How to Build the Training Village | Training village</title>
        <meta property="og:title"
            content="How to Build the Training Village | Training village" />
        <meta name="twitter:title"
            content="How to Build the Training Village | Training village" />
        <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8d216cef" />
        <link rel="stylesheet" type="text/css" href="_static/theme.css?v=edd7d3d2" />
        <link rel="stylesheet" type="text/css" href="_static/custom.css?v=04772280" />
        <link rel="canonical" href="https://BrainCircuitsBehaviorLab.github.io/village/how_to_build_index.html" />
        <link rel="icon" href="_static/favicon.svg" />
        <link rel="search" title="Search"
            href="search.html" />
        <link rel="index" title="Index"
            href="genindex.html" />
        <link rel="next" title="Data Collection"
            href="data_collection_index.html" />
        <link rel="prev" title="Receiving and responding to Telegram Alarms"
            href="user_guide/alarms.html" />

        <script>
    <!-- Prevent Flash of wrong theme -->
      const userPreference = localStorage.getItem('darkMode');
      let mode;
      if (userPreference === 'dark' || window.matchMedia('(prefers-color-scheme: dark)').matches) {
        mode = 'dark';
        document.documentElement.classList.add('dark');
      } else {
        mode = 'light';
      }
      if (!userPreference) {localStorage.setItem('darkMode', mode)}
    </script>
    </head>
    <body x-data="{ showSidebar: false, showScrollTop: false }"
        class="min-h-screen font-sans antialiased bg-background text-foreground"
        :class="{ 'overflow-hidden': showSidebar }">
        <div x-cloak x-show="showSidebar"
            class="fixed inset-0 z-50 overflow-hidden bg-background/80 backdrop-blur-sm md:hidden"
            @click.self="showSidebar = false"></div><div id="page" class="relative flex flex-col min-h-screen"><a href="#content"
                class="absolute top-0 left-0 z-[100] block bg-background p-4 text-xl transition -translate-x-full opacity-0 focus:translate-x-0 focus:opacity-100">
                Skip to content
            </a><header
  class="sticky top-0 z-40 w-full border-b shadow-sm border-border supports-backdrop-blur:bg-background/60 bg-background/95 backdrop-blur"><div class="container flex items-center h-14">
    <div class="hidden mr-4 md:flex">
      <a href="index.html" class="flex items-center mr-6">
          <img width="24" height="24" class="mr-2 hidden dark:block" src="_static/favicon-white.svg" alt="Logo" />
        <img width="24" height="24" class="mr-2 dark:hidden" src="_static/favicon.svg" alt="Logo" /><span class="hidden font-bold sm:inline-block text-clip whitespace-nowrap">Training village</span>
      </a></div><button
      class="inline-flex items-center justify-center h-10 px-0 py-2 mr-2 text-base font-medium transition-colors rounded-md hover:text-accent-foreground hover:bg-transparent md:hidden"
      type="button" @click="showSidebar = true">
      <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 96 960 960" aria-hidden="true"
        fill="currentColor">
        <path
          d="M152.587 825.087q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440Zm0-203.587q-19.152 0-32.326-13.174T107.087 576q0-19.152 13.174-32.326t32.326-13.174h320q19.152 0 32.326 13.174T518.087 576q0 19.152-13.174 32.326T472.587 621.5h-320Zm0-203.587q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440ZM708.913 576l112.174 112.174q12.674 12.674 12.674 31.826t-12.674 31.826Q808.413 764.5 789.261 764.5t-31.826-12.674l-144-144Q600 594.391 600 576t13.435-31.826l144-144q12.674-12.674 31.826-12.674t31.826 12.674q12.674 12.674 12.674 31.826t-12.674 31.826L708.913 576Z" />
      </svg>
      <span class="sr-only">Toggle navigation menu</span>
    </button>
    <div class="flex items-center justify-between flex-1 space-x-2 sm:space-x-4 md:justify-end">
      <div class="flex-1 w-full md:w-auto md:flex-none"><form id="searchbox"
      action="search.html"
      method="get"
      class="relative flex items-center group"
      @keydown.k.window.meta="$refs.search.focus()">
  <input x-ref="search"
          name="q"
          id="search-input"
          type="search"
          aria-label="Search the docs"
          placeholder="Search ..."
          class="inline-flex items-center font-medium transition-colors bg-transparent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ring-offset-background border border-input hover:bg-accent focus:bg-accent hover:text-accent-foreground focus:text-accent-foreground hover:placeholder-accent-foreground py-2 px-4 relative h-9 w-full justify-start rounded-[0.5rem] text-sm text-muted-foreground sm:pr-12 md:w-40 lg:w-64" />
  <kbd class="pointer-events-none absolute right-1.5 top-2 hidden h-5 select-none text-muted-foreground items-center gap-1 rounded border border-border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100 sm:flex group-hover:bg-accent group-hover:text-accent-foreground">
    <span class="text-xs">⌘</span>
    K
  </kbd>
</form>
      </div>
      <nav class="flex items-center space-x-1">
        <a href="https://github.com/BrainCircuitsBehaviorLab/village" title="Visit repository on GitHub" rel="noopener nofollow">
          <div
            class="inline-flex items-center justify-center px-0 text-sm font-medium transition-colors rounded-md disabled:opacity-50 disabled:pointer-events-none hover:bg-accent hover:text-accent-foreground h-9 w-9">
            <svg height="26px" style="margin-top:-2px;display:inline" viewBox="0 0 45 44" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M22.477.927C10.485.927.76 10.65.76 22.647c0 9.596 6.223 17.736 14.853 20.608 1.087.2 1.483-.47 1.483-1.047 0-.516-.019-1.881-.03-3.693-6.04 1.312-7.315-2.912-7.315-2.912-.988-2.51-2.412-3.178-2.412-3.178-1.972-1.346.149-1.32.149-1.32 2.18.154 3.327 2.24 3.327 2.24 1.937 3.318 5.084 2.36 6.321 1.803.197-1.403.759-2.36 1.379-2.903-4.823-.548-9.894-2.412-9.894-10.734 0-2.37.847-4.31 2.236-5.828-.224-.55-.969-2.759.214-5.748 0 0 1.822-.584 5.972 2.226 1.732-.482 3.59-.722 5.437-.732 1.845.01 3.703.25 5.437.732 4.147-2.81 5.967-2.226 5.967-2.226 1.185 2.99.44 5.198.217 5.748 1.392 1.517 2.232 3.457 2.232 5.828 0 8.344-5.078 10.18-9.916 10.717.779.67 1.474 1.996 1.474 4.021 0 2.904-.027 5.247-.027 5.96 0 .58.392 1.256 1.493 1.044C37.981 40.375 44.2 32.24 44.2 22.647c0-11.996-9.726-21.72-21.722-21.72" fill="currentColor"/></svg>
          </div>
        </a>
        
        <button @click="darkMode = darkMode === 'light' ? 'dark' : 'light'"
          class="relative inline-flex items-center justify-center px-0 text-sm font-medium transition-colors rounded-md hover:bg-accent hover:text-accent-foreground h-9 w-9"
          type="button"
          aria-label="Color theme switcher">
          <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 96 960 960" fill="currentColor"
            class="absolute transition-all scale-100 rotate-0 dark:-rotate-90 dark:scale-0">
            <path
              d="M480 685q45.456 0 77.228-31.772Q589 621.456 589 576q0-45.456-31.772-77.228Q525.456 467 480 467q-45.456 0-77.228 31.772Q371 530.544 371 576q0 45.456 31.772 77.228Q434.544 685 480 685Zm0 91q-83 0-141.5-58.5T280 576q0-83 58.5-141.5T480 376q83 0 141.5 58.5T680 576q0 83-58.5 141.5T480 776ZM80 621.5q-19.152 0-32.326-13.174T34.5 576q0-19.152 13.174-32.326T80 530.5h80q19.152 0 32.326 13.174T205.5 576q0 19.152-13.174 32.326T160 621.5H80Zm720 0q-19.152 0-32.326-13.174T754.5 576q0-19.152 13.174-32.326T800 530.5h80q19.152 0 32.326 13.174T925.5 576q0 19.152-13.174 32.326T880 621.5h-80Zm-320-320q-19.152 0-32.326-13.174T434.5 256v-80q0-19.152 13.174-32.326T480 130.5q19.152 0 32.326 13.174T525.5 176v80q0 19.152-13.174 32.326T480 301.5Zm0 720q-19.152 0-32.326-13.17Q434.5 995.152 434.5 976v-80q0-19.152 13.174-32.326T480 850.5q19.152 0 32.326 13.174T525.5 896v80q0 19.152-13.174 32.33-13.174 13.17-32.326 13.17ZM222.174 382.065l-43-42Q165.5 327.391 166 308.239t13.174-33.065q13.435-13.674 32.587-13.674t32.065 13.674l42.239 43q12.674 13.435 12.555 31.706-.12 18.272-12.555 31.946-12.674 13.674-31.445 13.413-18.772-.261-32.446-13.174Zm494 494.761-42.239-43q-12.674-13.435-12.674-32.087t12.674-31.565Q686.609 756.5 705.38 757q18.772.5 32.446 13.174l43 41.761Q794.5 824.609 794 843.761t-13.174 33.065Q767.391 890.5 748.239 890.5t-32.065-13.674Zm-42-494.761Q660.5 369.391 661 350.62q.5-18.772 13.174-32.446l41.761-43Q728.609 261.5 747.761 262t33.065 13.174q13.674 13.435 13.674 32.587t-13.674 32.065l-43 42.239q-13.435 12.674-31.706 12.555-18.272-.12-31.946-12.555Zm-495 494.761Q165.5 863.391 165.5 844.239t13.674-32.065l43-42.239q13.435-12.674 32.087-12.674t31.565 12.674Q299.5 782.609 299 801.38q-.5 18.772-13.174 32.446l-41.761 43Q231.391 890.5 212.239 890t-33.065-13.174ZM480 576Z" />
          </svg>
          <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 96 960 960" fill="currentColor"
            class="absolute transition-all scale-0 rotate-90 dark:rotate-0 dark:scale-100">
            <path
              d="M480 936q-151 0-255.5-104.5T120 576q0-138 90-239.5T440 218q25-3 39 18t-1 44q-17 26-25.5 55t-8.5 61q0 90 63 153t153 63q31 0 61.5-9t54.5-25q21-14 43-1.5t19 39.5q-14 138-117.5 229T480 936Zm0-80q88 0 158-48.5T740 681q-20 5-40 8t-40 3q-123 0-209.5-86.5T364 396q0-20 3-40t8-40q-78 32-126.5 102T200 576q0 116 82 198t198 82Zm-10-270Z" />
          </svg>
        </button>
      </nav>
    </div>
  </div>
</header>

            <div class="flex-1"><div
                    class="container flex-1 items-start md:grid md:grid-cols-[220px_minmax(0,1fr)] md:gap-6 lg:grid-cols-[240px_minmax(0,1fr)] lg:gap-10"><aside id="left-sidebar"
  class="fixed inset-y-0 left-0 md:top-14 z-50 md:z-30 bg-background md:bg-transparent transition-all duration-100 -translate-x-full md:translate-x-0 ml-0 p-6 md:p-0 md:-ml-2 md:h-[calc(100vh-3.5rem)] w-5/6 md:w-full shrink-0 overflow-y-auto border-r border-border md:sticky"
  :aria-hidden="!showSidebar" :class="{ 'translate-x-0': showSidebar }">

    <a href="index.html" class="!justify-start text-sm md:!hidden bg-background">
        <img width="16" height="16" class="mr-2 hidden dark:block" src="_static/favicon-white.svg" alt="Logo" />
        <img width="16" height="16" class="mr-2 dark:hidden" src="_static/favicon.svg" alt="Logo" /><span class="font-bold text-clip whitespace-nowrap">Training village</span>
    </a>

    <div class="relative overflow-hidden md:overflow-auto my-4 md:my-0 h-[calc(100vh-8rem)] md:h-auto">
      <div class="overflow-y-auto h-full w-full relative pr-6"><nav class="table w-full min-w-full my-6 lg:my-8">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="user_guide_index.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user_guide/getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_guide/remote.html">Configure remote access</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_guide/animal_procedures.html">Animal Procedures</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_guide/GUI.html">Using the GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_guide/telegram.html">Create a Telegram Bot</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_guide/project_structure.html">Project Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_guide/state_machine.html">System State Machine</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_guide/maintenance.html">Maintenance</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_guide/alarms.html">Receiving and responding to Telegram Alarms</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">How to Build the Training Village</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data_collection_index.html">Data Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources_index.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_index.html">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api_generated/village.devices.html">devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_generated/village.classes.html">classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_generated/village.gui.html">gui</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_generated/village.pybpodapi.html">pybpodapi</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_generated/village.screen.html">screen</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_generated/village.log.html">log</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_generated/village.rt_plots.html">rt_plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_generated/village.time_utils.html">time_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_generated/village.video.html">video</a></li>
</ul>
</li>
</ul>

</nav>
      </div>
    </div>
    <button type="button" @click="showSidebar = false"
      class="absolute md:hidden right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100">
      <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 96 960 960" fill="currentColor"
        stroke="none" class="h-4 w-4">
        <path
          d="M480 632 284 828q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536 576l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480 632Z" />
      </svg>
    </button>
  </aside>
                        <main
                            class="relative py-6 lg:gap-10 lg:py-8 xl:grid xl:grid-cols-[1fr_500px]">
<div class="w-full min-w-0 mx-auto">
<nav aria-label="breadcrumbs"
     class="flex items-center mb-4 space-x-1 text-sm text-muted-foreground">
  <a class="overflow-hidden text-ellipsis whitespace-nowrap hover:text-foreground"
     href="index.html">
    <span class="hidden md:inline">Training village</span>
    <svg xmlns="http://www.w3.org/2000/svg"
         height="18"
         width="18"
         viewBox="0 96 960 960"
         aria-label="Home"
         fill="currentColor"
         stroke="none"
         class="md:hidden">
      <path d="M240 856h120V616h240v240h120V496L480 316 240 496v360Zm-80 80V456l320-240 320 240v480H520V696h-80v240H160Zm320-350Z" />
    </svg>
  </a>
  
<div class="mr-1">/</div><span aria-current="page"
        class="font-medium text-foreground overflow-hidden text-ellipsis whitespace-nowrap">How to Build the Training Village</span>
</nav>

    <div id="content" role="main">
      <section id="how-to-build-the-training-village">
<h1>How to Build the Training Village</h1>
<div class="toctree-wrapper compound">
</div>
<section id="list-of-parts">
<h2>List of Parts</h2>
<p>Below are the detailed lists of what you’ll need to print, purchase, and assemble.</p>
<section id="d-printed-parts">
<h3>3D-Printed Parts</h3>
<p>You’ll need to 3D print the following parts to build the Mouse Village system. Make sure
to use the provided STL files in the <strong>original orientation</strong> for accuracy (the
parts <strong>don’t need supports</strong> unless mentioned):</p>
<ul class="simple">
<li><p><strong>Corridor Lower parts</strong></p>
<ul>
<li><p>Tunnel components</p></li>
<li><p>Door mechanisms</p></li>
<li><p>Enclosures for the electronics</p></li>
</ul>
</li>
<li><p><strong>Corridor Upper parts</strong></p>
<ul>
<li><p>Tunnel components</p></li>
</ul>
</li>
<li><p><strong>Cage connectors</strong></p>
<ul>
<li><p>Tunnel components</p></li>
<li><p>Door mechanisms</p></li>
<li><p>Enclosures for the electronics</p></li>
</ul>
</li>
</ul>
<p><a class="reference internal" href="TODO-LINK.html"><span class="std std-doc">Download all the 3D printing files here</span></a></p>
</section>
<section id="cnc-machined-parts">
<h3>CNC Machined Parts</h3>
<p>Below are the CAD files for the parts that need to be CNC machined:</p>
<ul class="simple">
<li><p><strong>Transparent Acrylic Components</strong>:</p>
<ul>
<li><p><strong>Corridor Lid</strong>: The lid that covers the corridor.</p></li>
<li><p><strong>Corridor Lid Stops</strong>: These stops ensure that the mice cannot push up the corridor
lid and escape the system.</p></li>
</ul>
</li>
<li><p><strong>White Acrylic Components</strong>:</p>
<ul>
<li><p><strong>Base</strong>: The foundation where the Mouse Village is mounted.</p></li>
<li><p><strong>Doors</strong>: CNC machined doors for the system.</p></li>
<li><p><strong>Blockers</strong>: These blockers are used during maintenance to keep the mice inside the
system without needing to handle them. They fit into a slot on each cage connector,
preventing the mice from exiting when the tubes are disconnected.</p></li>
</ul>
</li>
</ul>
</section>
<section id="aluminium-extrusions-and-tubes">
<h3>Aluminium Extrusions and Tubes</h3>
<p>For the structural support and frame of the Mouse Village system, you will need
aluminium extrusions and tubes. These provide durability and stability to the entire
setup. Below is a basic list of what you’ll need:</p>
<ul class="simple">
<li><p><strong>Aluminium Extrusions</strong>:</p>
<ul>
<li><p>20x20 mm extrusions (for the chamber frame)</p></li>
<li><p>30x30 mm extrusions (for heavier support sections)</p></li>
</ul>
</li>
<li><p><strong>Tubes</strong>:</p>
<ul>
<li><p>Aluminium tubes (for connecting various components and ensuring rigidity)</p></li>
</ul>
</li>
</ul>
<p>Make sure to source these parts from reliable suppliers to ensure quality and fit.</p>
<p>Feel free to follow the instructions in the
<a class="reference internal" href="how_to_build/assembly_instructions.html"><span class="std std-doc">Assembly Instructions Section</span></a>
for detailed guidance on how to assemble the Training Village system.</p>
</section>
<section id="electronic-components">
<h3>Electronic Components</h3>
<p>Here’s the list of all the electronic components you will need to purchase:</p>
<ul class="simple">
<li><p><strong>Sensors</strong>:</p>
<ul>
<li><p>RFID reader</p></li>
<li><p>Infrared beams for position detection</p></li>
</ul>
</li>
<li><p><strong>Motors</strong>:</p>
<ul>
<li><p>Motorized doors (for mouse sorting and chamber access)</p></li>
</ul>
</li>
<li><p><strong>Microcontrollers</strong>:</p>
<ul>
<li><p>Arduino (for controlling sorting and automation)</p></li>
</ul>
</li>
<li><p><strong>Other Components</strong>:</p>
<ul>
<li><p>Water reward pump</p></li>
<li><p>Piezoelectric buzzer</p></li>
<li><p>IR camera for monitoring</p></li>
<li><p>Power supply and cables</p></li>
</ul>
</li>
</ul>
<p><a class="reference internal" href="TODO-LINK.html"><span class="std std-doc">View the electronic components list here</span></a></p>
</section>
</section>
<section id="assembly-instructions">
<h2>Assembly Instructions</h2>
<p>We provide comprehensive instructions to help you build the Training Village system,
using the [3D-printed parts] and electronic components. You can either download the full
PDF manual or view it directly on this page.</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="_downloads/0eebfe4106e6b559d43d72c9c6aa8d59/training-village-instructions.pdf"><span class="xref download myst">Download the PDF Assembly Instructions</span></a></p></li>
</ul>
<p>Alternatively, you can view it inline below:</p>
<details markdown="block">
<summary>View the PDF Assembly Instructions</summary>
<object
data="https://braincircuitsbehaviorlab.github.io/village/_static/training-village-instructions.pdf"
width="100%"
height="1000"
type="application/pdf">
Your browser does not support viewing PDFs. Please download the PDF to view it.
</object>
</details>
</section>
<section id="software-installation">
<h2>Software Installation</h2>
<p>You can download a ready-to-use ISO image containing the operating system (Raspberry Pi OS) along with all necessary libraries and Python code pre-installed <a class="reference internal" href="TODO-LINK.html"><span class="std std-doc">here</span></a>.</p>
<p>Follow the instructions on this page if you prefer a manual installation. The process can be challenging, so proceed only if you have a basic understanding of Linux distributions and are comfortable using the terminal.</p>
<section id="what-you-need">
<h3>What You Need</h3>
<ul class="simple">
<li><p>Raspberry Pi 5 - 8GB</p></li>
<li><p>Fan</p></li>
<li><p>Micro SD 128GB</p></li>
<li><p>Keyboard</p></li>
<li><p>Mouse</p></li>
<li><p>Screen</p></li>
<li><p>Micro HDMI to HDMI cable</p></li>
<li><p>Power supply for Raspberry Pi</p></li>
<li><p>2 Raspberry Pi Camera Module 3 Wide Noir</p></li>
<li><p>Ethernet cable (optional)</p></li>
<li><p>Raspberry Pi Dac Pro (optional)</p></li>
<li><p>2 servo motors</p></li>
<li><p>RFID sensor</p></li>
<li><p>Weight sensor</p></li>
<li><p>Temperature sensor</p></li>
</ul>
</section>
<section id="launch-raspberry-pi-os-for-the-first-time">
<h3>Launch Raspberry Pi OS for the First Time</h3>
<ol class="arabic simple">
<li><p>Connect a keyboard, mouse, and screen to the Raspberry Pi.</p></li>
<li><p>Connect the Ethernet cable if you are going to use an Ethernet connection.</p></li>
<li><p>If your SD card has the OS preinstalled, jump to step 4.</p></li>
<li><p>If your SD card is empty, follow these instructions to download the OS and copy it to the SD: <a class="reference external" href="https://www.raspberrypi.com/software/">Raspberry Pi OS</a></p></li>
<li><p>Insert the SD card and start the Raspberry Pi.</p></li>
<li><p>Select your country and keyboard language and choose English as the general language.</p></li>
<li><p>Type <code class="docutils literal notranslate"><span class="pre">raspberry</span></code> as the username and choose the password you want.</p></li>
<li><p>Select your Wi-Fi or Ethernet connection.</p></li>
<li><p>Choose your preferred web browser (Chromium).</p></li>
<li><p>Select “Yes” when asked to update software (if you have your internet connection ready).</p></li>
</ol>
</section>
<section id="updating-the-system">
<h3>Updating the System</h3>
<ol class="arabic simple">
<li><p>Make sure you have internet connection and then update the software. <a class="reference external" href="https://www.raspberrypi.com/documentation/computers/os.html">Detailed instructions</a>.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">sudo</span> <span class="n">apt</span> <span class="n">update</span>
</span><span id="line-2"><span class="n">sudo</span> <span class="n">apt</span> <span class="n">full</span><span class="o">-</span><span class="n">upgrade</span>
</span></code></pre></div>
</div>
</section>
<section id="installing-needed-libraries">
<h3>Installing Needed Libraries</h3>
<ol class="arabic simple">
<li><p>Install OpenCV (library to manage video):</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">python3</span><span class="o">-</span><span class="n">opencv</span>
</span><span id="line-2"><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">opencv</span><span class="o">-</span><span class="n">data</span>
</span></code></pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Install sound libraries: TODO check if pulseaudio is really needed.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">pulseaudio</span>
</span><span id="line-2"><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">libportaudio2</span>
</span></code></pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Install PyQT5 multimedia</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">python3</span><span class="o">-</span><span class="n">pyqt5</span><span class="o">.</span><span class="n">qtmultimedia</span>
</span><span id="line-2"><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">libqt5multimedia5</span><span class="o">-</span><span class="n">plugins</span>
</span></code></pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Install VS Code (optional):</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">code</span>
</span></code></pre></div>
</div>
</section>
<section id="creating-a-python-environment-and-installing-pip-libraries">
<h3>Creating a Python Environment and Installing pip Libraries</h3>
<ol class="arabic simple">
<li><p>Create a <code class="docutils literal notranslate"><span class="pre">.env</span></code> environment that includes all the packages installed in the global
Python environment:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">venv</span> <span class="o">--</span><span class="n">system</span><span class="o">-</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span> <span class="o">~/.</span><span class="n">env</span>
</span></code></pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Activate it:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">source</span> <span class="o">~/.</span><span class="n">env</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">activate</span>
</span></code></pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Install needed libraries with pip:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">pip</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">dateutil</span>
</span><span id="line-2"><span class="n">pip</span> <span class="n">install</span> <span class="n">setuptools_scm</span>
</span><span id="line-3"><span class="n">pip</span> <span class="n">install</span> <span class="n">sounddevice</span>
</span><span id="line-4"><span class="n">pip</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">telegram</span><span class="o">-</span><span class="n">bot</span>
</span><span id="line-5"><span class="n">pip</span> <span class="n">install</span> <span class="n">scipy</span>
</span></code></pre></div>
</div>
</section>
<section id="changing-preferences">
<h3>Changing Preferences</h3>
<ol class="arabic simple">
<li><p>Enable auto-login by clicking on <strong>Preferences</strong> -&gt; <strong>Raspberry Pi Configuration</strong> -&gt; <strong>Auto login</strong>.</p></li>
<li><p>Add CPU monitors to the toolbar: Right-click on the toolbar, select <strong>Add/Remove Panel Items</strong>, and click <strong>Add</strong>. Select <strong>CPU Temperature Monitor</strong> and <strong>CPU Usage monitor</strong>.</p></li>
</ol>
</section>
<section id="screen-settings">
<h3>Screen Settings</h3>
<ol class="arabic simple">
<li><p>Run the raspi-config.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">sudo</span> <span class="n">raspi</span><span class="o">-</span><span class="n">config</span>
</span></code></pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Go to <strong>Display Options</strong> and disable blanking.</p></li>
<li><p>Go to <strong>Advanced Options</strong> and select X11 (instead of Wayland).</p></li>
</ol>
<p>Then, you need to configure the system to recognize a screen even if none is physically connected, so the software renders properly when accessed remotely. If you want to use an additional screen to present stimuli in the behavioral box, you need to set the system to work with two screens.</p>
<ol class="arabic simple" start="4">
<li><p>Modify the file: <code class="docutils literal notranslate"><span class="pre">/boot/firmware/cmdline.txt</span></code></p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">sudo</span> <span class="n">nano</span> <span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">firmware</span><span class="o">/</span><span class="n">cmdline</span><span class="o">.</span><span class="n">txt</span>
</span></code></pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Add the following text: <code class="docutils literal notranslate"><span class="pre">vc4.fvc4.force_hotplug=1</span></code> if you are using only one screen,
or <code class="docutils literal notranslate"><span class="pre">vc4.fvc4.force_hotplug=3</span></code> if you are using two screens.</p></li>
</ol>
<p>Explanation of values: (1 makes the system operate as if a screen is connected to HDMI 1). (2 makes the system operate as if a screen is connected to HDMI 2). (3 makes the system operate as if screens are connected to both HDMI 1 and HDMI 2).</p>
<ol class="arabic simple" start="6">
<li><p>Change the resolution of the screen (or screens) to 1280 x 720: <strong>Preferences</strong> -&gt;
<strong>Screen Configuration</strong>.</p></li>
</ol>
</section>
<section id="i2c-communication">
<h3>I2C Communication</h3>
<p>The temperature sensor and the weight sensor are connected to the I2C pins of the Raspberry.</p>
<ol class="arabic simple">
<li><p>First, activate the I2C communication:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">sudo</span> <span class="n">raspi</span><span class="o">-</span><span class="n">config</span>
</span></code></pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Go to <strong>Interface Options</strong> and enable I2C.</p></li>
</ol>
<p>The system is configured to work with address = 0x45 for the temperature sensor (DFRobot HX711) and address = 0x64 for the weight sensor (CQRobot SHT31). If you are using different models or if the devices are not recognized, follow these steps to verify that the addresses are correct:</p>
<ol class="arabic simple" start="3">
<li><p>Connect the devices to the raspberry.</p></li>
<li><p>Install the detection tools:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">i2c</span><span class="o">-</span><span class="n">tools</span>
</span></code></pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Run the tools:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">i2cdetect</span> <span class="o">-</span><span class="n">y</span> <span class="mi">1</span>
</span></code></pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Change the addresses in the python code by modifying the corresponding settings in
<code class="docutils literal notranslate"><span class="pre">village/settings.py</span></code> (extra_settings).</p></li>
</ol>
</section>
<section id="accessing-pins-via-hardware-for-servos-and-using-uart-pin-for-communication">
<h3>Accessing Pins via Hardware (for Servos) and Using UART Pin for Communication</h3>
<p>To access the pins via hardware (faster and less jittery than software access), and to allow the use of the UART Pin for communication with the sensors you need to change two settings:</p>
<ol class="arabic simple">
<li><p>Edit the <code class="docutils literal notranslate"><span class="pre">/boot/firmware/config.txt</span></code> file to include the following:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="p">[</span><span class="nb">all</span><span class="p">]</span>
</span><span id="line-2"><span class="n">dtoverlay</span><span class="o">=</span><span class="n">pwm</span><span class="o">-</span><span class="mi">2</span><span class="n">chan</span><span class="p">,</span><span class="n">pin</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">pin2</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span><span class="n">func</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">func2</span><span class="o">=</span><span class="mi">4</span>
</span><span id="line-3"><span class="n">enable_uart</span><span class="o">=</span><span class="mi">1</span>
</span></code></pre></div>
</div>
</section>
<section id="udev-rules-for-consistent-usb-device-naming">
<h3>Udev Rules for Consistent USB Device Naming</h3>
<p>When you connect your Bpod device to the Raspberry Pi, it’s assigned a file path in <code class="docutils literal notranslate"><span class="pre">/dev/</span></code>, typically named <code class="docutils literal notranslate"><span class="pre">ttyACM0</span></code>. However, this name may vary (ttyACM1, ttyACM2, etc.), especially if you have other USB devices connected. To ensure a consistent and recognizable name, you can create a symbolic link to your Bpod device.</p>
<ol class="arabic simple">
<li><p>Navigate to the Udev rules folder where custom rules are stored:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="nb">cd</span><span class="w"> </span>/etc/udev/rules.d
</span></code></pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Create a new rule file named <code class="docutils literal notranslate"><span class="pre">99-usb.rules</span></code>:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">sudo<span class="w"> </span>nano<span class="w"> </span><span class="m">99</span>-usb.rules
</span></code></pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>In the new rule file, add the following line to create a symbolic link named <code class="docutils literal notranslate"><span class="pre">Bpod</span></code> for any device that matches the pattern <code class="docutils literal notranslate"><span class="pre">ttyACM*</span></code>. This will allow any device named ttyACM* (where * can be any number) to be consistently linked, provided it’s connected
to a specific USB port (in this case, the port associated with <code class="docutils literal notranslate"><span class="pre">KERNELS==3-1:1.0</span></code>).</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">KERNEL</span><span class="o">==</span><span class="s2">&quot;ttyACM*&quot;</span><span class="p">,</span><span class="n">KERNELS</span><span class="o">==</span><span class="s2">&quot;3-1:1.0&quot;</span><span class="p">,</span><span class="n">SYMLINK</span><span class="o">+=</span><span class="s2">&quot;Bpod&quot;</span>
</span></code></pre></div>
</div>
<p>Note: The USB port identifier (KERNELS==“3-1:1.0”) may vary depending on the physical USB port you are using. For reference, the 3-1:1.0 port on the Raspberry Pi is usually the USB port next to the Ethernet connection. To confirm the exact port identifier, you can use the command <code class="docutils literal notranslate"><span class="pre">dmesg</span></code> after connecting the device.</p>
<ol class="arabic simple" start="4">
<li><p>Activate the new rule by triggering the Udev process:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="n">sudo</span> <span class="n">udevadm</span> <span class="n">trigger</span>
</span></code></pre></div>
</div>
<p>Now, whenever the Bpod device is connected to the specified USB port, it will consistently appear with the symbolic link <code class="docutils literal notranslate"><span class="pre">/dev/Bpod</span></code>, regardless of its dynamic ttyACM* designation.</p>
</section>
<section id="install-village">
<h3>Install village</h3>
<ol class="arabic simple">
<li><p>Make sure you are in .env environment (see above)</p></li>
<li><p>Clone the repo inside your <code class="docutils literal notranslate"><span class="pre">/home/raspberry/</span></code> directory. In the terminal, type: <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">https://github.com/BrainCircuitsBehaviorLab/village.git</span></code></p></li>
<li><p>Navigate to folder <code class="docutils literal notranslate"><span class="pre">village</span></code> and type <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.</span></code></p></li>
<li><p>You’re ready to start the system by simply running the <code class="docutils literal notranslate"><span class="pre">main.py</span></code> file. Just execute: <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">/home/raspberry/village/village/main.py</span></code></p></li>
</ol>
</section>
</section>
</section>

    </div></div><aside id="right-sidebar" class="hidden text-sm xl:block">
  <div class="sticky top-16 -mt-10 max-h-[calc(100vh-5rem)] overflow-y-auto pt-6 space-y-2"><p class="font-medium">On this page</p>
    <ul>
<li><a class="reference internal" href="#list-of-parts">List of Parts</a><ul>
<li><a class="reference internal" href="#d-printed-parts">3D-Printed Parts</a></li>
<li><a class="reference internal" href="#cnc-machined-parts">CNC Machined Parts</a></li>
<li><a class="reference internal" href="#aluminium-extrusions-and-tubes">Aluminium Extrusions and Tubes</a></li>
<li><a class="reference internal" href="#electronic-components">Electronic Components</a></li>
</ul>
</li>
<li><a class="reference internal" href="#assembly-instructions">Assembly Instructions</a></li>
<li><a class="reference internal" href="#software-installation">Software Installation</a><ul>
<li><a class="reference internal" href="#what-you-need">What You Need</a></li>
<li><a class="reference internal" href="#launch-raspberry-pi-os-for-the-first-time">Launch Raspberry Pi OS for the First Time</a></li>
<li><a class="reference internal" href="#updating-the-system">Updating the System</a></li>
<li><a class="reference internal" href="#installing-needed-libraries">Installing Needed Libraries</a></li>
<li><a class="reference internal" href="#creating-a-python-environment-and-installing-pip-libraries">Creating a Python Environment and Installing pip Libraries</a></li>
<li><a class="reference internal" href="#changing-preferences">Changing Preferences</a></li>
<li><a class="reference internal" href="#screen-settings">Screen Settings</a></li>
<li><a class="reference internal" href="#i2c-communication">I2C Communication</a></li>
<li><a class="reference internal" href="#accessing-pins-via-hardware-for-servos-and-using-uart-pin-for-communication">Accessing Pins via Hardware (for Servos) and Using UART Pin for Communication</a></li>
<li><a class="reference internal" href="#udev-rules-for-consistent-usb-device-naming">Udev Rules for Consistent USB Device Naming</a></li>
<li><a class="reference internal" href="#install-village">Install village</a></li>
</ul>
</li>
</ul>
</div>
</aside>
                        </main>
                    </div>
                </div><footer class="py-6 border-t border-border md:py-0">
    <div class="container flex flex-col items-center justify-between gap-4 md:h-24 md:flex-row">
      <div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0">
        <p class="text-sm leading-loose text-center text-muted-foreground md:text-left">© 2024, Rafael Marin, Balma Serrano, Hernando Vergara&nbsp;Built with <a class="font-medium underline underline-offset-4"
    href="https://www.sphinx-doc.org"
    rel="noreferrer">Sphinx 8.1.3</a></p>
</div>
</div>
</footer>
            </div>
            
            <script src="_static/documentation_options.js?v=5f8e0446"></script>
            <script src="_static/doctools.js?v=9bcbadda"></script>
            <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
            <script defer="defer" src="_static/theme.js?v=1808ab49"></script>
            <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
            
        </body>
    </html>